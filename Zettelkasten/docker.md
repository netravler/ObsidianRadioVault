![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYwMCIgaGVpZ2h0PSI4NDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+)![How to persist data in Docker: Volumes](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1628100791156%2FtJC3tzNPH.png%3Fw%3D1600%26h%3D840%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=3840&q=75)

# How to persist data in Docker: Volumes

## What are Docker Volumes and why do we need them? Two Examples

[![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4=)![Francesco Ciulla's photo](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1607888008934%2F2qgL3Z4Q7.png%3Fw%3D200%26h%3D200%26fit%3Dcrop%26crop%3Dfaces%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=640&q=75)](https://hashnode.com/@FrancescoCiulla)

[Francesco Ciulla](https://hashnode.com/@FrancescoCiulla)

·[Aug 4, 2021](https://blog.tinystacks.com/how-to-persist-data-in-docker-volumes)·

6 min read

Subscribe to our newsletter and never miss any upcoming articles

SUBSCRIBE

Today, we’re going to talk about persistence for containers, specifically Docker volumes.

if you want to check the Video, check this link [youtu.be/Ff0OCpEwDnQ](https://youtu.be/Ff0OCpEwDnQ)

### Why Persistence?

Why do we need to talk about this? After all, outside of containers, persistence is an assumed feature! We always just use the filesystem of the running machine - even in a virtual machine.

But for containers, it’s a bit more complicated.

By default, all files created inside a container are stored on a writable layer for the container.

This means that the data doesn’t persist when the container is removed. Yes, you will lose all the cookies if you store them inside a container! Don’t do that.

Docker has two main options to solve this problem: **volumes** and **bind mounts**. For this article, we will focus on Docker volumes. ([You can read more about bind mounts](https://docs.docker.com/storage/bind-mounts/) on the Docker site.)

---

### VOLUMES

Volumes are one of the four Docker Objects - four key concepts you must understand to use containers properly.The Docker Objects are:

Images Containers Volumes Networks

Volumes are the preferred way to persist data in Docker

They are easier to back up or migrate than bind mounts. They are manageable using either the CLI or the Docker API. They can be more safely shared among multiple containers. Volume drivers let you store volumes on remote hosts or cloud providers, to encrypt the contents of volumes, or to add other functionality. New volumes can have their content pre-populated by a container. Higher performance on Docker Desktop for windows and Mac

Volumes are stored in a part of the host filesystem managed by Docker. The exact folder depends on the operating system. For example, on Linux, it's:

COPY

```
/var/lib/docker/volumes/
```

Non-Docker processes should never modify these files.

How do volumes work? When you create a volume, it's stored in a directory on the Docker host. When you mount the volume into a container, this directory is mounted in the container. Volumes are managed by Docker and are isolated from the other core functionalities of the host machine.

Simple and effective.

Let's see a demo.

### Demo

To show volumes, you can type the following from your Docker host’s command line:

COPY

```
docker volume ls
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627635465337/HsKpxQ6Ok.png?auto=compress,format&format=webp)

As you can see, there are no volumes on this host.

To create a volume, type:

COPY

```
docker volume create volume1
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627635523430/sIxmF1IOT.png?auto=compress,format&format=webp)

Volumes are the preferred mechanism for persisting data generated by and used by Docker containers, for the reasons given before .

We can get important information about the volume by typing:

COPY

```
docker volume inspect volume1
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627635565744/0ngcDm_WQ.png?auto=compress,format&format=webp)

We can see some information here. However, there are no containers connected to this volume we’ve just created.

So how can we use a volume with a container?

When we run a container, we can specify the option -v, so the container will now use that volume to persist data:

COPY

```
docker run -it -v volume1:/app ubuntu bash
```

-   `volume1` is the name of the volume.
-   `/app` is the folder inside the container.

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627637083688/dcLP9Slbz.png?auto=compress,format&format=webp)

Since we don't have the Ubuntu image on our computer, Docker will first pull that image from Docker Hub, the main public container registry maintained by Docker where many images are stored.

Let’s inspect the volume:

COPY

```
docker volume inspect volume1
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627637580767/q81QxA3q9.png?auto=compress,format&format=webp)

Now we can see that the volume is connected to the container. The part shown on the left is the name of the volume; the part on the right is the destination path.

Now let's check the filesystem of the container:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627637640359/2HPPc0s9vx.png?auto=compress,format&format=webp)

Now let's test persistence. Let's get into the app folder and create a new file. Well call it TinyStacks (of course):

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627638706379/jyuNz2gu1.png?auto=compress,format&format=webp)

And then, let's exit:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627638678209/s2Qd_orHq.png?auto=compress,format&format=webp)

Let's remove the container:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627639269633/NA1-c4Rxy.png?auto=compress,format&format=webp)

And now let's create another container, using the same volume:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627639632241/3_p9hyBFe.png?auto=compress,format&format=webp)

And there we go, there is our TinyStacks folder!

Now, this is great. But the best use case for using volumes is with a database.

### POSTGRES

For example, we can use Postgres. Postgres, also known as PostgreSQL is, [according to their own definition](https://www.postgresql.org/),"a powerful, open-source object-relational database system with over 30 years of active development that has earned it a strong reputation for reliability, feature robustness, and performance."

And this is true, it's pretty powerful. Also, since it’s popular, if you encounter a problem, you can find tons of resources online.

You can install Postgres using a link on the official site....

But we are NOT going to do that.

Instead, let's use an existing image on DockerHub!

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627640474669/23Tu3c2pc.png?auto=compress,format&format=webp)

Now how can we use this image to run our Postgres container?

### POSTGRES EXAMPLE

COPY

```
docker run -d --name postgresexample -e POSTGRES_PASSWORD=12345 -e POSTGRES_USER=francesco -v pgvolume:/var/lib/postgresql/data -p 5432:5432 postgres:12
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627641803442/ouHRvq74o.png?auto=compress,format&format=webp)

Now, if we type:

COPY

```
docker volume ls
```

We see something like this:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627641950009/XYpv3siRJ.png?auto=compress,format&format=webp)

We see the previous volume, but also a new one. Why? Because if we define a volume when we run a container, and that volume does not exist, Docker creates it for us. Thank you, Docker!

Ok, now let's use the `docker exec` command to get into the existing postgres container and use psql. [psql](https://www.postgresql.org/docs/13/app-psql.html) is an interactive terminal usedto create tables and inserts via SQL from the command prompt:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627643331071/FK8QBXsn6.png?auto=compress,format&format=webp)

COPY

```
docker exec -it postgresexample psql -U francesco
```

Let's run some SQL commands. To check the existing relations and tables, type:

COPY

```
\dt
```

We don't find any relations. Which is expected.

Then we can create a table using a SQL statement:

COPY

```
CREATE TABLE users (id int, username text);
```

We’re creating a table with the field id as an integer and the field username as text. Remember the semicolon at the end of the command!

If we type `\dt` again, now we see the table:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627644368431/42EkESS2W.png?auto=compress,format&format=webp)

Okay, let's make a couple of inserts into this database.

First insert:

COPY

```
INSERT INTO users (id,username) VALUES (1,'mario');
```

Second insert:

COPY

```
 INSERT INTO users (id,username) VALUES (2,'luigi');
```

To check these inserts, we can type:

COPY

```
 select * from users;
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627645534562/XYpTt7irg.png?auto=compress,format&format=webp)

Now let's exit the psql container:![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627645580416/ru06Tv27H.png?auto=compress,format&format=webp)

Let’s stop and remove the existing container:

COPY

```
docker rm -f postgresexample
```

As a side note, we can see that, even if we remove the Postgres container, the volume is still there.Let's check it:

COPY

```
docker volume ls
```

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627645840153/L7l8eBGxx.png?auto=compress,format&format=webp)

Now let’s run another Postgres container from the same image (for Postgres compatibility), and using the same volume (this is important):

COPY

```
docker run -d --name newpostgresexample -e POSTGRES_PASSWORD=12345 -e POSTGRES_USER=francesco -v pgvolume:/var/lib/postgresql/data -p 5432:5432 postgres:12
```

This time, since we already had the postgres:12 image, it runs almost instantly:

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627646437585/5N5YqqKrN.png?auto=compress,format&format=webp)

Let's get inside the container again:

COPY

```
docker exec -it newpostgresexample psql -U francesco
```

As you can see, we haven’t lost our data!

![image.png](https://cdn.hashnode.com/res/hashnode/image/upload/v1627647406481/9vIwS75ES.png?auto=compress,format&format=webp)

In the next article, we’ll see a much better way to use volumes with the command `docker compose` and with a docker-compose file.

if you want to check the Video, check this link [youtu.be/Ff0OCpEwDnQ](https://youtu.be/Ff0OCpEwDnQ)

[#docker](https://hashnode.com/n/docker)[#containers](https://hashnode.com/n/containers)[#postgresql](https://hashnode.com/n/postgresql)[#ubuntu](https://hashnode.com/n/ubuntu)[#docker-images](https://hashnode.com/n/docker-images)

[![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjU2IiBoZWlnaHQ9IjI1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB2ZXJzaW9uPSIxLjEiLz4=)![TinyStacks](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1623717754093%2FJsECgJJmC.png%3Fw%3D256%26h%3D256%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=640&q=75)](https://blog.tinystacks.com/)

### PUBLISHED ON

# [TinyStacks](https://blog.tinystacks.com/)

Follow

Build, operate and scale backend stacks on your AWS account in minutes so your team can build better.

![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjQiIGhlaWdodD0iNjQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+)![Post reaction](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1594643688456%2FnznpsvvJs.png%3Fh%3D64%26w%3D64%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=128&q=75)1

[](https://blog.tinystacks.com/how-to-persist-data-in-docker-volumes#write-comment)

[](https://twitter.com/share?url=https%3A%2F%2Fblog.tinystacks.com%2Fhow-to-persist-data-in-docker-volumes&text=How%20to%20persist%20data%20in%20Docker%3A%20Volumes%0D%0A%7B%20by%20%40FrancescoCiull4%20%7D%20from%20%40hashnode%0D%0A%0A%23docker%20%23containers%20%23postgresql%20%23ubuntu%20%23dockerimages)

### MORE ARTICLES

[![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+)![Jay Allen's photo](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1628629019556%2FFx1CP2eKM.jpeg%3Fw%3D70%26h%3D70%26fit%3Dcrop%26crop%3Dfaces%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=256&q=75)](https://hashnode.com/@jayallen)

[Jay Allen](https://hashnode.com/@jayallen)

[![Post cover](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1643404231478%2FrUvCqGWE2.png%3Fw%3D500%26h%3D262%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=3840&q=75)](https://blog.tinystacks.com/aws-api-gateway-rest-http)

# [API Gateway REST vs. HTTP API: What Are The Differences?](https://blog.tinystacks.com/aws-api-gateway-rest-http)

[AWS API Gateway is a great technology for managing and securing access to your backend REST APIs. Ho…](https://blog.tinystacks.com/aws-api-gateway-rest-http)

[![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+)![Jay Allen's photo](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1628629019556%2FFx1CP2eKM.jpeg%3Fw%3D70%26h%3D70%26fit%3Dcrop%26crop%3Dfaces%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=256&q=75)](https://hashnode.com/@jayallen)

[Jay Allen](https://hashnode.com/@jayallen)

[![Post cover](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1642184895088%2FkYRG_k9PO.png%3Fw%3D500%26h%3D262%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=3840&q=75)](https://blog.tinystacks.com/aiven-aws-pricing)

# [Aiven vs. Direct AWS Data Hosting: Which is Better?](https://blog.tinystacks.com/aiven-aws-pricing)

[Aiven is a new company that aims to simplify data storage and management in the cloud. In this artic…](https://blog.tinystacks.com/aiven-aws-pricing)

[![](data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNzAiIGhlaWdodD0iNzAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmVyc2lvbj0iMS4xIi8+)![Jay Allen's photo](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1628629019556%2FFx1CP2eKM.jpeg%3Fw%3D70%26h%3D70%26fit%3Dcrop%26crop%3Dfaces%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=256&q=75)](https://hashnode.com/@jayallen)

[Jay Allen](https://hashnode.com/@jayallen)

[![Post cover](https://blog.tinystacks.com/_next/image?url=https%3A%2F%2Fcdn.hashnode.com%2Fres%2Fhashnode%2Fimage%2Fupload%2Fv1641656301143%2FZVmeh86FL.png%3Fw%3D500%26h%3D262%26fit%3Dcrop%26crop%3Dentropy%26auto%3Dcompress%2Cformat%26format%3Dwebp&w=3840&q=75)](https://blog.tinystacks.com/canary-testing-backend-api-aws)

# [Canary Testing Your Backend API on AWS](https://blog.tinystacks.com/canary-testing-backend-api-aws)

[No matter how much you test a new version of your API before release, the true test occurs when you …](https://blog.tinystacks.com/canary-testing-backend-api-aws)

### Comments

Write a comment

©2022 TinyStacks.

[Archive](https://blog.tinystacks.com/archive)·[Privacy policy](https://hashnode.com/privacy?source=blog-footer)·[Terms](https://hashnode.com/terms?source=blog-footer)

[Publish with Hashnod](https://hashnode.com/onboard?unlock-blog=true&source=blog-footer)